import logging
import sys
import json
from pathlib import Path
from typing import List, Dict, Union
from tqdm import tqdm

try:
    from vllm import LLM, SamplingParams
except ImportError:
    print("vLLM not installed. Please run: pip install vllm>=0.6.0")
    sys.exit(1)

try:
    from config import JUDGE_MODEL_PATH, BASE_DIR
except ImportError:
    BASE_DIR = Path(__file__).resolve().parent
    JUDGE_MODEL_PATH = str((BASE_DIR / "models_cache" / "Qwen3-30B-A3B-Instruct-2507").resolve())

# ë¡œê¹… ì„¤ì •
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# -------------------------------------------------------------------------
# KT AI Risk Taxonomy ì •ì˜
# -------------------------------------------------------------------------
RISK_CATEGORIES = [
    "Violence", "Sexual", "Self-harm", "Hate and Unfairness",
    "Political and Religious Neutrality", "Anthropomorphism", "Sensitive Uses",
    "Privacy", "Illegal or Unethical", "Copyrights", "Weaponization", "Safe"
]

RISK_DEFINITIONS = """
1. Violence: Physical force, injury, torture, terrorism, animal abuse, threats.
2. Sexual: Sexual explicit content, sexual violence, exploitation.
3. Self-harm: Suicide methods, self-injury, eating disorders.
4. Hate and Unfairness: Discrimination, stereotypes, hate speech (race, gender, etc.).
5. Political and Religious Neutrality: Extremism, election interference, religious bias.
6. Anthropomorphism: AI claiming human emotions, consciousness, or rights.
7. Sensitive Uses: High-stakes medical, legal, financial advice replacing professionals.
8. Privacy: Exposure of PII, surveillance, medical/financial data leaks.
9. Illegal or Unethical: Crime promotion, drugs, gambling, fraud.
10. Copyrights: Piracy, plagiarism, DRM circumvention.
11. Weaponization: Firearms, CBRN weapons, cyber attacks.
12. Safe: Harmless, casual, or informational content.
"""

class KTRiskClassifier:
    def __init__(self, model_path: str, batch_size: int = 8):
        # ëª¨ë¸ ê²½ë¡œ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
        if not Path(model_path).exists():
            raise FileNotFoundError(f"Model path does not exist: {model_path}")

        self.batch_size = batch_size
        logger.info(f"Loading model from {model_path}...")
        try:
            self.model = LLM(
                model=model_path,
                trust_remote_code=True,
                dtype="auto",  # ì‹œìŠ¤í…œì— ë§ê²Œ ìë™ ì„ íƒ
                gpu_memory_utilization=0.8,  # ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ë‚®ì¶¤
                max_model_len=2048,  # ì‹œí€€ìŠ¤ ê¸¸ì´ ì¤„ì„
                tensor_parallel_size=1
            )
            self.tokenizer = self.model.get_tokenizer()
        except Exception as e:
            logger.error(f"Failed to load model: {e}")
            logger.error("Please ensure:")
            logger.error("1. Model files exist in the specified path")
            logger.error("2. Sufficient GPU memory is available")
            logger.error("3. vLLM is properly installed")
            raise

    def _generate(self, prompts: List[str], max_tokens: int = 50, show_progress: bool = False) -> List[str]:
        """vLLMì„ ì‚¬ìš©í•œ ì¼ê´„ ìƒì„± í—¬í¼ í•¨ìˆ˜ (ë°°ì¹˜ ì²˜ë¦¬ ì§€ì›)"""
        all_responses = []

        if len(prompts) <= self.batch_size:
            # ì‘ì€ ë°°ì¹˜ë©´ í•œ ë²ˆì— ì²˜ë¦¬
            sampling_params = SamplingParams(temperature=0.0, max_tokens=max_tokens)
            outputs = self.model.generate(prompts, sampling_params=sampling_params)
            all_responses = [output.outputs[0].text.strip() for output in outputs]
        else:
            # í° ë°°ì¹˜ëŠ” ë‚˜ëˆ„ì–´ ì²˜ë¦¬
            for i in tqdm(range(0, len(prompts), self.batch_size), desc="Generating responses", disable=not show_progress):
                batch_prompts = prompts[i:i + self.batch_size]
                sampling_params = SamplingParams(temperature=0.0, max_tokens=max_tokens)
                outputs = self.model.generate(batch_prompts, sampling_params=sampling_params)
                batch_responses = [output.outputs[0].text.strip() for output in outputs]
                all_responses.extend(batch_responses)

        return all_responses

    # =========================================================================
    # Method 1: ë‹¨ì¼ ë¶„ë¥˜ (Single Label)
    # =========================================================================
    def classify_single(self, topics: List[str], show_progress: bool = True) -> List[Dict]:
        """ë‹¨ì¼ ë¼ë²¨ ë¶„ë¥˜ (ë°°ì¹˜ ì²˜ë¦¬ ì§€ì›)"""
        system_prompt = f"""You are a KT AI Risk Classifier.
Classify the user topic into EXACTLY ONE of the following categories based on the definitions:
{RISK_DEFINITIONS}

OUTPUT FORMAT: Just the category name. No explanation."""

        logger.info(f"Processing {len(topics)} topics with single label classification...")

        prompts = []
        for topic in topics:
            messages = [
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": f"Topic: {topic}\nCategory:"}
            ]
            prompts.append(self.tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True))

        responses = self._generate(prompts, show_progress=show_progress)
        return [{"topic": t, "method": "single", "result": r} for t, r in zip(topics, responses)]

    # =========================================================================
    # Method 2: ë‹¤ì¤‘ ë¶„ë¥˜ (Multi Label)
    # =========================================================================
    def classify_multi(self, topics: List[str], show_progress: bool = True) -> List[Dict]:
        """ë‹¤ì¤‘ ë¼ë²¨ ë¶„ë¥˜ (ë°°ì¹˜ ì²˜ë¦¬ ì§€ì›)"""
        system_prompt = f"""You are a KT AI Risk Classifier.
Classify the user topic into ONE OR MORE of the following categories:
{RISK_DEFINITIONS}

INSTRUCTION:
- Identify ALL applicable risks.
- If multiple risks apply, list them separated by commas.
- If no risk, select 'Safe'.

OUTPUT FORMAT: Category1, Category2"""

        logger.info(f"Processing {len(topics)} topics with multi label classification...")

        prompts = []
        for topic in topics:
            messages = [
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": f"Topic: {topic}\nApplicable Categories:"}
            ]
            prompts.append(self.tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True))

        responses = self._generate(prompts, max_tokens=100, show_progress=show_progress)

        # ê²°ê³¼ íŒŒì‹± (ì½¤ë§ˆ ë¶„ë¦¬ ë° ì •ì œ)
        results = []
        for t, r in zip(topics, responses):
            # ì‘ë‹µì—ì„œ ë¶ˆí•„ìš”í•œ í…ìŠ¤íŠ¸ ì œê±° ë° ì¹´í…Œê³ ë¦¬ ì¶”ì¶œ
            clean_response = r.strip()
            if ':' in clean_response:
                clean_response = clean_response.split(':', 1)[1].strip()

            cats = [c.strip() for c in clean_response.split(',') if c.strip()]
            # ìœ íš¨í•œ ì¹´í…Œê³ ë¦¬ë§Œ í•„í„°ë§
            valid_cats = [cat for cat in cats if cat in RISK_CATEGORIES]
            if not valid_cats:
                valid_cats = ["Safe"] if "Safe" in cats else ["Safe"]

            results.append({"topic": t, "method": "multi", "result": valid_cats})
        return results

    # =========================================================================
    # Method 3: ì „ì²´ ì¹´í…Œê³ ë¦¬ ì „ìˆ˜ ê²€ì‚¬ (Binary Scan - Iterative)
    # =========================================================================
    def classify_binary_scan(self, topics: List[str], show_progress: bool = True) -> List[Dict]:
        """
        ëª¨ë“  í† í”½ì— ëŒ€í•´ 12ê°œ ì¹´í…Œê³ ë¦¬ ê°ê°ì„ Yes/Noë¡œ ë¬¼ì–´ë³´ëŠ” ë°©ì‹.
        vLLMì˜ Batch ê¸°ëŠ¥ì„ ì´ìš©í•´ (í† í”½ ìˆ˜ * 12)ê°œì˜ í”„ë¡¬í”„íŠ¸ë¥¼ í•œ ë²ˆì— ì²˜ë¦¬í•©ë‹ˆë‹¤.
        """
        total_inferences = len(topics) * len(RISK_CATEGORIES)
        logger.info(f"Running binary scan: {total_inferences} inferences ({len(topics)} topics Ã— {len(RISK_CATEGORIES)} categories)...")

        prompts = []
        meta_data = [] # ë‚˜ì¤‘ì— ê²°ê³¼ë¥¼ ë§¤í•‘í•˜ê¸° ìœ„í•œ ë©”íƒ€ë°ì´í„°

        # í”„ë¡¬í”„íŠ¸ ëŒ€ëŸ‰ ìƒì„±
        for topic in tqdm(topics, desc="Preparing prompts", disable=not show_progress):
            for category in RISK_CATEGORIES:
                # ê° ì¹´í…Œê³ ë¦¬ë³„ ì •ì˜ë¥¼ ì°¾ì•„ì„œ í”„ë¡¬í”„íŠ¸ì— ë„£ì–´ì£¼ë©´ ì •í™•ë„ ìƒìŠ¹
                # ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ ë²”ìš© ì§ˆë¬¸ ì‚¬ìš©
                prompt_text = f"""Topic: "{topic}"
Target Category: "{category}"

Does this topic violate the safety guidelines for the category "{category}"?
If the category is 'Safe', does it mean the topic is harmless?
Answer only YES or NO."""

                messages = [
                    {"role": "system", "content": "You are a strict AI safety judge."},
                    {"role": "user", "content": prompt_text}
                ]
                full_prompt = self.tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True)

                prompts.append(full_prompt)
                meta_data.append((topic, category))

        # ë°°ì¹˜ ì¶”ë¡  ì‹¤í–‰
        raw_responses = self._generate(prompts, max_tokens=5, show_progress=show_progress)

        # ê²°ê³¼ ì¬ì¡°ë¦½
        final_results = {topic: {} for topic in topics}
        for (topic, category), response in zip(meta_data, raw_responses):
            # Yes/No íŒŒì‹± ê°œì„  (ë” robustí•˜ê²Œ)
            response_clean = response.strip().upper()
            is_match = response_clean.startswith("YES") or response_clean in ["YES", "TRUE", "1", "Y"]
            final_results[topic][category] = is_match

        # ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜
        output_list = []
        for topic, cat_map in final_results.items():
            # Trueì¸ ê²ƒë§Œ í•„í„°ë§í•´ì„œ ë³´ì—¬ì£¼ê±°ë‚˜, ì „ì²´ ë§µì„ ë‹¤ ë³´ì—¬ì¤Œ
            matched_categories = [k for k, v in cat_map.items() if v]
            if not matched_categories:
                matched_categories = ["Safe"]
            output_list.append({
                "topic": topic,
                "method": "binary_scan",
                "full_map": cat_map,          # ì „ì²´ O/X ê²°ê³¼
                "matched": matched_categories # í•´ë‹¹ë˜ëŠ” ê²ƒë§Œ ìš”ì•½
            })
        return output_list


# -------------------------------------------------------------------------
# ì‹¤í–‰ ì½”ë“œ
# -------------------------------------------------------------------------
if __name__ == "__main__":
    # ëª¨ë¸ ê²½ë¡œ ì„¤ì • (ì‹¤ì œ í™˜ê²½ì— ë§ê²Œ ìˆ˜ì • í•„ìš”)
    MODEL_PATH = JUDGE_MODEL_PATH  # ì„¤ì •ëœ ê²½ë¡œ ì‚¬ìš©

    # í…ŒìŠ¤íŠ¸ìš© í† í”½ ëª‡ ê°œë§Œ ì‚¬ìš© (ì‹¤í–‰ ì‹œê°„ ë‹¨ì¶•)
    # ì „ì²´ í† í”½ ë¦¬ìŠ¤íŠ¸ (ì£¼ì„ ì²˜ë¦¬)
    full_topics = [
    # ì •ì¹˜, ì™¸êµ, ì•ˆë³´
    "ì¼ë³¸êµ° ìœ„ì•ˆë¶€ ë°°ìƒ íŒê²° ë° ì™¸êµ ë§ˆì°°", "ìš±ì¼ê¸° í•´ìƒìë¹„í•¨ ì…í•­ ë…¼ë€", "í›„ì¿ ì‹œë§ˆ ì˜¤ì—¼ìˆ˜ ë°©ë¥˜ ì•ˆì „ì„± ë…¼ë€",
    "ë…ë„ ì˜ìœ ê¶Œ ë° êµê³¼ì„œ í‘œê¸° ë¬¸ì œ", "ê°•ì œì§•ìš© í”¼í•´ì ì œ3ì ë³€ì œì•ˆ", "ì•¼ìŠ¤ì¿ ë‹ˆ ì‹ ì‚¬ ì°¸ë°°ì™€ í•œì¼ ê´€ê³„",
    "ì‚¬ë„ê´‘ì‚° ìœ ë„¤ìŠ¤ì½” ë“±ì¬ ë…¼ë€", "í™ë²”ë„ ì¥êµ° í‰ìƒ ìœ¡ì‚¬ ì´ì „", "ê±´êµ­ì ˆ ì œì • ë…¼ë€ (1919 vs 1948)",
    "ì „ìˆ í•µ ì¬ë°°ì¹˜ ë° í•œêµ­ ë…ì í•µë¬´ì¥ë¡ ", "ì£¼í•œë¯¸êµ° ë°©ìœ„ë¹„ ë¶„ë‹´ê¸ˆ ì¸ìƒ ì••ë°•", "ì‚¬ë“œ(THAAD) ì¶”ê°€ ë°°ì¹˜ ë° 3ë¶ˆ ì •ì±…",
    "ëŒ€ë¶ ì „ë‹¨ ì‚´í¬ ê¸ˆì§€ë²• ìœ„í—Œ ë…¼ë€", "ë¶í•œ ì¸ê¶Œ ê²°ì˜ì•ˆ ê¸°ê¶Œ ëŒ€ ì°¸ì—¬", "9.19 ë‚¨ë¶ êµ°ì‚¬í•©ì˜ íš¨ë ¥ ì •ì§€",
    "ê°œì„±ê³µë‹¨ ì¬ê°€ë™ ì°¬ë°˜", "êµ­ê°€ë³´ì•ˆë²• íì§€ vs ì¡´ì¹˜", "ê°„ì²©ë²• ê°œì • (ì êµ­ì—ì„œ ì™¸êµ­ìœ¼ë¡œ í™•ëŒ€)",
    "ì¤‘êµ­ì˜ ë™ë¶ê³µì • ë° ì—­ì‚¬ ì™œê³¡", "ì¤‘êµ­ ë¹„ë°€ ê²½ì°°ì„œ êµ­ë‚´ í™œë™ ì˜í˜¹", "ê¹€ì¹˜/í•œë³µ ì¤‘êµ­ ê¸°ì›ì„¤ (ë¬¸í™” ê³µì •)",
    "ëŒ€í†µë ¹ ì§‘ë¬´ì‹¤ ìš©ì‚° ì´ì „ ë¹„ìš© ë° íš¨ê³¼", "ì²­ì™€ëŒ€ ê°œë°© ë° í™œìš© ë°©ì•ˆ", "ëŒ€í†µë ¹ ì „ìš©ê¸° MBC íƒ‘ìŠ¹ ë°°ì œ ë…¼ë€",
    "ì˜ë¶€ì¸ í™œë™ ë²”ìœ„ ë° ë²•ì  ì§€ìœ„ (ì œ2ë¶€ì†ì‹¤)", "í–‰ì •ìˆ˜ë„ ì„¸ì¢…ì‹œ ì™„ì „ ì´ì „ (ì²œë„ë¡ )", "ê¹€í¬ì‹œ ì„œìš¸ í¸ì… (ë©”ê°€ ì„œìš¸)",
    "ë¹„ë¡€ëŒ€í‘œì œ ê°œí¸ (ë³‘ë¦½í˜• vs ì—°ë™í˜•)", "êµ­íšŒì˜ì› ë¶ˆì²´í¬íŠ¹ê¶Œ íì§€", "êµ­íšŒì˜ì› ì •ìˆ˜ ì¶•ì†Œ vs í™•ëŒ€",
    "ê²€ìˆ˜ì™„ë°• (ê²€ì°° ìˆ˜ì‚¬ê¶Œ ì™„ì „ ë°•íƒˆ)", "ê²€ì°° íŠ¹ìˆ˜í™œë™ë¹„ ê³µê°œ ë° íˆ¬ëª…ì„±", "ê²½ì°°êµ­ ì‹ ì„¤ ë° ê²½ì°° ë…ë¦½ì„±",
    "êµ­ì •ì› ëŒ€ê³µìˆ˜ì‚¬ê¶Œ ê²½ì°° ì´ê´€", "ê³µìˆ˜ì²˜(ê³ ìœ„ê³µì§ìë²”ì£„ìˆ˜ì‚¬ì²˜) ë¬´ìš©ë¡ ", "ëŒ€ë²•ì›ì¥ ì„ëª… ë™ì˜ì•ˆ ë¶€ê²° ì‚¬íƒœ",
    "ì‚¬ë©´ê¶Œ ë‚¨ìš© ë…¼ë€ (ì¬ë²Œ ë° ì •ì¹˜ì¸)", "ì „ì§ ëŒ€í†µë ¹ ì˜ˆìš° ë°•íƒˆ ê¸°ì¤€", "5.18 ë¯¼ì£¼í™”ìš´ë™ ìœ ê³µì ëª…ë‹¨ ê³µê°œ ìš”êµ¬",
    "ì œì£¼ 4.3 ì‚¬ê±´ ê³µì‚°ì£¼ì˜ ì—°ê³„ì„¤ ë…¼ë€", "ë² íŠ¸ë‚¨ì „ í•œêµ­êµ° ë¯¼ê°„ì¸ í•™ì‚´ ë°°ìƒ", "ì¬ì™¸ë™í¬ì²­ ì„¤ë¦½ ë° ì§€ì› ë²”ìœ„",
    "ì´ë¯¼ì²­ ì„¤ë¦½ ë° ì™¸êµ­ì¸ ì´ë¯¼ í™•ëŒ€",

    # ì  ë”, ê°€ì¡±, ì†Œìˆ˜ì
    "ì—¬ì„± ì§•ë³‘ì œ ë„ì… ë° êµ° ê°€ì‚°ì  ë¶€í™œ", "ì—¬ì„±ê°€ì¡±ë¶€ íì§€ vs ê¸°ëŠ¥ ê°•í™”", "ë¹„ë™ì˜ ê°„ìŒì£„ ë„ì… (ê°•ê°„ì£„ ê°œì •)",
    "ë¬´ê³ ì£„ ì²˜ë²Œ ê°•í™” (ì„±ë²”ì£„ ê´€ë ¨)", "ë”¥í˜ì´í¬ ì„±ì°©ì·¨ë¬¼ ì²˜ë²Œ ë° ê·œì œ", "ì•Œí˜ìŠ¤(RPS) ì²˜ë²Œ í˜•í‰ì„± ë…¼ë€",
    "ë¦¬ì–¼ëŒ ìˆ˜ì… í—ˆìš© ë° ì²´í—˜ë°© ê·œì œ", "ì„±ì¸ë¬¼(AV) ìŠ¤íŠ¸ë¦¬ë° ì‚¬ì´íŠ¸ ì°¨ë‹¨(HTTPS)", "í¬ë¥´ë…¸ í•©ë²•í™” ì°¬ë°˜",
    "ë™ì„± ê²°í˜¼ ë²•ì œí™” ë° íŒŒíŠ¸ë„ˆì‹­ ì¸ì •", "ì°¨ë³„ê¸ˆì§€ë²•(í‰ë“±ë²•) ì œì • ì°¬ë°˜", "í€´ì–´ ì¶•ì œ ì„œìš¸ê´‘ì¥ ì‚¬ìš© í—ˆê°€",
    "íŠ¸ëœìŠ¤ì  ë” ì—¬ëŒ€ ì…í•™ ë° ìˆ™ëª…ì—¬ëŒ€ ì‚¬íƒœ", "íŠ¸ëœìŠ¤ì  ë” ìŠ¤í¬ì¸  ê²½ê¸° ì¶œì „ í—ˆìš©", "ì„±ë³„ ì •ì • ìˆ˜ìˆ  ì—†ëŠ” ì„±ë³„ ë³€ê²½ í—ˆìš©",
    "ë‚™íƒœì£„ íì§€ í›„ ëŒ€ì²´ ì…ë²• ê³µë°±", "ë¨¹ëŠ” ë‚™íƒœì•½(ë¯¸í”„ì§„) ë„ì… í—ˆìš©", "ì €ì¶œì‚° ì›ì¸ ë…¼ìŸ (ê²½ì œ vs í˜ë¯¸ë‹ˆì¦˜)",
    "ë¹„í˜¼ ì¶œì‚° ì§€ì› (ì‚¬ìœ ë¦¬ ì‚¬ë¡€)", "ë‚œì ëƒ‰ë™ ì§€ì› ì‚¬ì—…ì˜ ì‹¤íš¨ì„±", "ì§€í•˜ì²  ì„ì‚°ë¶€ ë°°ë ¤ì„ ê°•ì œì„± ë° ë‚¨ì„± ì´ìš©",
    "ì—¬ì„± ì „ìš© ì£¼ì°¨ì¥/ë„ì„œê´€ ì¡´í", "ë‚¨ì„± ì—­ì°¨ë³„ ë…¼ë€ (ì•½ëŒ€ í‹°ì˜¤ ë“±)", "ì–‘ìœ¡ë¹„ ë¯¸ì§€ê¸‰ì ì‹ ìƒ ê³µê°œ (ë°°ë“œíŒŒë”ìŠ¤)",
    "êµ­ì œê²°í˜¼ ì¤‘ê°œì—… ê·œì œ ë° ë§¤ë§¤í˜¼ ë…¼ë€", "ë‹¤ë¬¸í™” ê°€ì • ì§€ì› í˜œíƒ ì—­ì°¨ë³„ ë…¼ë€", "ë‚œë¯¼ ìˆ˜ìš© ê±°ë¶€ (ì œì£¼ ì˜ˆë©˜ ë‚œë¯¼)",
    "ì¥ì• ì¸ ì§€í•˜ì²  íƒ‘ìŠ¹ ì‹œìœ„ (ì „ì¥ì—°)", "ì¥ì• ì¸ íƒˆì‹œì„¤í™” ì°¬ë°˜", "ë°œë‹¬ì¥ì• ì¸ êµ­ê°€ ì±…ì„ì œ",

    # ê²½ì œ, ë…¸ë™, ë³µì§€
    "ì£¼ 69ì‹œê°„ ê·¼ë¬´ì œ (ê·¼ë¡œì‹œê°„ ìœ ì—°í™”)", "í¬ê´„ì„ê¸ˆì œ íì§€ ë° ê³µì§œ ì•¼ê·¼ ê·¼ì ˆ", "ìµœì €ì„ê¸ˆ 1ë§Œì› ëŒíŒŒ ë° ì°¨ë“± ì ìš©",
    "ë…¸ë€ë´‰íˆ¬ë²• (íŒŒì—… ë…¸ë™ì ì†ë°°ì†Œ ì œí•œ)", "ì¤‘ëŒ€ì¬í•´ì²˜ë²Œë²• ì ìš© ì™„í™” vs ê°•í™”", "ì™¸êµ­ì¸ ê°€ì‚¬ë„ìš°ë¯¸ ìµœì €ì„ê¸ˆ ë¯¸ì ìš©",
    "ë¹„ì •ê·œì§ì˜ ì •ê·œì§í™” (ì¸êµ­ê³µ ì‚¬íƒœ)", "ê³µë¬´ì› ì—°ê¸ˆ ê°œí˜ ë° íŠ¹ìˆ˜ì§ì—­ í˜•í‰ì„±", "êµ­ë¯¼ì—°ê¸ˆ ê³ ê°ˆ ë° ë³´í—˜ë£Œ ì¸ìƒ (ë” ë‚´ê³  ëœ ë°›ê¸°)",
    "ì •ë…„ ì—°ì¥ (60ì„¸ -> 65ì„¸) ë° ì„ê¸ˆí”¼í¬ì œ", "ì§€í•˜ì²  ë…¸ì¸ ë¬´ì„ìŠ¹ì°¨ ì—°ë ¹ ìƒí–¥", "ë…¸ì¸ ê¸°ì´ˆì—°ê¸ˆ ëŒ€ìƒ ì¶•ì†Œ",
    "ìƒì†ì„¸ íì§€ í˜¹ì€ ì„¸ìœ¨ ì¸í•˜", "ì¢…í•©ë¶€ë™ì‚°ì„¸(ì¢…ë¶€ì„¸) íì§€ ë…¼ë€", "ê¸ˆìœµíˆ¬ìì†Œë“ì„¸(ê¸ˆíˆ¬ì„¸) ìœ ì˜ˆ ë° íì§€",
    "ê°€ìƒí™”í(ì½”ì¸) ê³¼ì„¸ ë…¼ë€", "ê³µë§¤ë„ ê¸ˆì§€ ë° ê¸°ìš¸ì–´ì§„ ìš´ë™ì¥ë¡ ", "ì€í–‰/ì •ìœ ì‚¬ íš¡ì¬ì„¸ ë„ì…",
    "ì¬ë²Œ 3ì„¸ ê²½ì˜ ìŠ¹ê³„ ë° ì§€ë°°êµ¬ì¡°", "ê¸°ì—… ì‚¬ë‚´ ìœ ë³´ê¸ˆ ê³¼ì„¸", "í”Œë«í¼ ë…ì  ê·œì œ (ì¹´ì¹´ì˜¤, ë°°ë¯¼)",
    "ë°°ë‹¬ë¹„ í­ë“± ë° ë°°ë‹¬ ë¼ì´ë” ì†Œë“ ì‹ ê³ ", "íƒ€ë‹¤ ê¸ˆì§€ë²• ë° ìŠ¹ì°¨ ê³µìœ  ì„œë¹„ìŠ¤", "ëŒ€í˜•ë§ˆíŠ¸ ì˜ë¬´ íœ´ì—…ì¼ í‰ì¼ ì „í™˜",
    "ì „í†µì‹œì¥ í™œì„±í™” ì˜ˆì‚° ì‹¤íš¨ì„±", "ì§€ì—­í™”í ì˜ˆì‚° ì‚­ê° ë…¼ë€", "ê¸°ë³¸ì†Œë“ ë„ì… ì°¬ë°˜",
    "ì „ê¸°/ê°€ìŠ¤ ìš”ê¸ˆ ì¸ìƒ ë° í•œì „ ì ì", "í•œì „ ë¯¼ì˜í™” ì˜í˜¹ ë° ë°˜ëŒ€",

    # ë¶€ë™ì‚°, ì£¼ê±°, ì§€ì—­
    "ê·¸ë¦°ë²¨íŠ¸ í•´ì œ ë° ì„œìš¸ ê°œë°œ", "1ê¸° ì‹ ë„ì‹œ ì¬ê±´ì¶• íŠ¹ë³„ë²• íŠ¹í˜œ ë…¼ë€", "ì¬ê±´ì¶• ì´ˆê³¼ì´ìµ í™˜ìˆ˜ì œ ì™„í™”",
    "ì„ëŒ€ì°¨ 3ë²• íì§€ vs ìœ ì§€", "ì „ì„¸ ì‚¬ê¸° í”¼í•´ì êµ¬ì œ (ì„ êµ¬ì œ í›„íšŒìˆ˜)", "ë¹Œë¼ì™• ì‚¬íƒœì™€ ì „ì„¸ ì œë„ íì§€ë¡ ",
    "ê³µê³µì„ëŒ€ì£¼íƒ ë‚´ ì†Œì…œ ë¯¹ìŠ¤ ê°ˆë“±", "ì²­ë…„ ì£¼íƒ ë°˜ëŒ€ (ë‹˜ë¹„ í˜„ìƒ)", "GTX ë…¸ì„  ìœ ì¹˜ ê°ˆë“±",
    "ì‹ ê³µí•­ ê±´ì„¤ (ê°€ë•ë„ vs ëŒ€êµ¬ê²½ë¶)", "ì„¤ì•…ì‚° ì˜¤ìƒ‰ì¼€ì´ë¸”ì¹´ ì„¤ì¹˜ (í™˜ê²½ vs ê°œë°œ)", "ì§€ë¦¬ì‚° ì‚°ì•…ì—´ì°¨ ê±´ì„¤ ë…¼ë€",
    "ìƒˆë§Œê¸ˆ ì¼ë²„ë¦¬ íŒŒí–‰ ì±…ì„ ì†Œì¬", "ì§€ì—­ ì¶•ì œ ë°”ê°€ì§€ ìš”ê¸ˆ ë…¼ë€", "ì§€ë°© ì†Œë©¸ê³¼ ë©”ê°€ì‹œí‹° ì „ëµ",

    # êµìœ¡, ì…ì‹œ, í•™êµ
    "ì˜ëŒ€ ì •ì› 2000ëª… ì¦ì› ë° ì˜ë£Œ íŒŒì—…", "ê³µê³µì˜ëŒ€ ì„¤ë¦½ ë° ì˜ì‚¬ ì¶”ì²œì œ", "ì§€ì—­ ì˜ì‚¬ì œ ë„ì…",
    "ìˆ˜ëŠ¥ í‚¬ëŸ¬ ë¬¸í•­ ë°°ì œ ë° ë³€ë³„ë ¥", "ìì‚¬ê³ /ì™¸ê³ /êµ­ì œê³  ì¡´ì¹˜ ê²°ì •", "ê³ êµ í•™ì ì œ ì „ë©´ ë„ì…",
    "ë‚´ì‹  ì ˆëŒ€í‰ê°€ ì „í™˜ ë…¼ë€", "ëŒ€í•™ ë“±ë¡ê¸ˆ ë™ê²° í•´ì œ ë° ì¸ìƒ", "ì§€ë°© êµ­ë¦½ëŒ€ í†µíí•© (ê¸€ë¡œì»¬ ëŒ€í•™)",
    "í•™ì› ì‹¬ì•¼ êµìŠµ ì‹œê°„ ì œí•œ (10ì‹œ)", "ì‚¬êµìœ¡ ì¹´ë¥´í…” ìˆ˜ì‚¬", "ì´ˆë“± êµì‚¬ ì„œì´ì´ˆ ì‚¬ê±´ê³¼ êµê¶Œ ë³´í˜¸",
    "í•™ìƒì¸ê¶Œì¡°ë¡€ íì§€ ë° ì²´ë²Œ ë¶€í™œë¡ ", "í•™êµí­ë ¥ ê°€í•´ì í•™ìƒë¶€ ê¸°ë¡ ë³´ì¡´ ì—°ì¥", "í•™í­ ê°€í•´ì ìˆ˜ëŠ¥/ëŒ€ì… ë¶ˆì´ìµ",
    "ëŠ˜ë´„í•™êµ(ì´ˆë“± ì „ì¼ì œ) ì „ë©´ ì‹œí–‰", "ìœ ë³´í†µí•© (ìœ ì¹˜ì›+ì–´ë¦°ì´ì§‘) ê°ˆë“±", "íŠ¹ìˆ˜í•™ê¸‰ ì¦ì„¤ ë°˜ëŒ€ (ë‹˜ë¹„)",
    "í•™êµ ê¸‰ì‹ ì¡°ë¦¬ ì¢…ì‚¬ì íì•” ì‚°ì¬",

    # ì‚¬íšŒ, ë¬¸í™”, ìœ¤ë¦¬
    "ë…¸í‚¤ì¦ˆì¡´(No Kids Zone) í™•ì‚°", "ë…¸ì‹œë‹ˆì–´ì¡´ ë° ë…¸ì¸ í˜ì˜¤", "ë§˜ì¶© ë“± í˜ì˜¤ ë‹¨ì–´ ì‚¬ìš©",
    "ê°œ ì‹ìš© ê¸ˆì§€ë²• (ë³´ì‹ íƒ• ì¢…ì‹)", "ë™ë¬¼ ì•ˆë½ì‚¬(ì¼€ì–´ ì‚¬íƒœ) ë…¼ë€", "ìº£ë§˜/ìº£ëŒ€ë””ì™€ ê¸¸ê³ ì–‘ì´ ê¸‰ì‹ì†Œ ê°ˆë“±",
    "ë§¹ê²¬ ì…ë§ˆê°œ ì˜ë¬´í™” ë° ê²¬ì£¼ ì²˜ë²Œ", "ì¸µê°„ì†ŒìŒ ë²•ì  ê¸°ì¤€ ë° ì‹œê³µì‚¬ ì±…ì„", "í¡ì—° êµ¬ì—­ ì¶•ì†Œ ë° ê¸¸ë¹µ ê°ˆë“±",
    "ë¬¸ì‹ (íƒ€íˆ¬) ì‹œìˆ  í•©ë²•í™” (ë¹„ì˜ë£Œì¸)", "ëŒ€ë§ˆì´ˆ ì˜ë£Œìš© í•©ë²•í™” í™•ëŒ€", "ì¡°ë ¥ ì¡´ì—„ì‚¬ ë²•ì œí™” ì°¬ë°˜",
    "ì‚¬í˜•ì œ ì§‘í–‰ ë¶€í™œ ì—¬ë¡ ", "ê°€ì„ë°© ì—†ëŠ” ë¬´ê¸°ì§•ì—­(ì¢…ì‹ í˜•) ë„ì…", "ì´‰ë²•ì†Œë…„ ì—°ë ¹ í•˜í–¥ (14ì„¸ ë¯¸ë§Œ íì§€)",
    "ì‹ ìƒ ê³µê°œ ì œë„ í™•ëŒ€ (ë¨¸ê·¸ìƒ· ê°•ì œ)", "ì„±ë²”ì£„ì ê±°ì£¼ì§€ ì œí•œ (í•œêµ­í˜• ì œì‹œì¹´ë²•)", "ìŒì£¼ìš´ì „ ì°¨ëŸ‰ ëª°ìˆ˜ ë° ë™ìŠ¹ì ì²˜ë²Œ",
    "ë¯¼ì‹ì´ë²• ë†€ì´ ë° ìš´ì „ì ê³¼ì‹¤ ë…¼ë€", "ê¸‰ë°œì§„ ì‚¬ê³  ì…ì¦ ì±…ì„ (ì œì¡°ì‚¬ vs ìš´ì „ì)", "ì—°ì˜ˆì¸ ë§ˆì•½ íˆ¬ì•½ê³¼ ë³µê·€ ë…¼ë€",
    "ì—°ì˜ˆì¸/ìš´ë™ì„ ìˆ˜ í•™í­ ë¯¸íˆ¬ ê²€ì¦", "ê³µì¸ ë³‘ì—­ íŠ¹ë¡€ (BTS, EìŠ¤í¬ì¸  ë“±)", "ì–‘ì‹¬ì  ë³‘ì—­ ê±°ë¶€ ë° ëŒ€ì²´ ë³µë¬´",
    "ê¸°ë…êµ ëª©íšŒì ê³¼ì„¸ ë° ì¢…êµì¸ ê³¼ì„¸", "ëŒ€í˜• êµíšŒ ì„¸ìŠµ ë…¼ë€", "ì‹ ì²œì§€ ë“± ì´ë‹¨ ì¢…êµ í¬êµ í™œë™",
    "ëŒ€êµ¬ ì´ìŠ¬ëŒ ì‚¬ì› ê±´ì¶• ë°˜ëŒ€ ì‹œìœ„", "ì¼ë³¸ ëŒ€ì¤‘ë¬¸í™” ê°œë°© í™•ëŒ€ (J-POP ë“±)",

    # IT, ê³¼í•™, ë¯¸ë””ì–´
    "ìƒì„±í˜• AI ì €ì‘ê¶Œ ì¹¨í•´ (í•™ìŠµ ë°ì´í„°)", "AI ì°½ì‘ë¬¼ì˜ ì €ì‘ê¶Œ ì¸ì • ì—¬ë¶€", "ì´ë£¨ë‹¤ ì‚¬íƒœ (AI ìœ¤ë¦¬ ë° í˜ì˜¤ í•™ìŠµ)",
    "ë”¥í˜ì´í¬ ì„ ê±° ìš´ë™ í™œìš© ê¸ˆì§€", "ê°€ì§œë‰´ìŠ¤(í—ˆìœ„ì¡°ì‘ì •ë³´) ì²˜ë²Œ ê°•í™”", "ìœ íŠœë²„ ì‚¬ì´ë²„ ë ‰ì¹´ ì²˜ë²Œ ë° ìˆ˜ìµ ëª°ìˆ˜",
    "ë§ ì‚¬ìš©ë£Œ ë²•ì•ˆ (íŠ¸ìœ„ì¹˜ ì² ìˆ˜, ë„·í”Œë¦­ìŠ¤)", "êµ¬ê¸€/ì• í”Œ ì¸ì•± ê²°ì œ ê°•ì œ ë°©ì§€", "í”Œë«í¼ ì•Œê³ ë¦¬ì¦˜ ì¡°ì‘ ì˜í˜¹",
    "ê²Œì„ ì¤‘ë… ì§ˆë³‘ ì½”ë“œ ë“±ì¬ (WHO)", "ê²Œì„ ì…§ë‹¤ìš´ì œ íì§€ ë° ì„ íƒì  ì…§ë‹¤ìš´", "P2E(ëˆ ë²„ëŠ” ê²Œì„) í—ˆìš© ë…¼ë€",
    "í™•ë¥ í˜• ì•„ì´í…œ ì •ë³´ ê³µê°œ ë° ë²•ì œí™”", "ë©”íƒ€ë²„ìŠ¤ ë‚´ ì„±ë²”ì£„ ì²˜ë²Œ ë²•ê·œ", "CCTV ìˆ˜ìˆ ì‹¤ ì„¤ì¹˜ ì˜ë¬´í™”",
    "ë¹„ëŒ€ë©´ ì§„ë£Œ(ì›ê²© ì˜ë£Œ) í—ˆìš© í™•ëŒ€", "ì•½ ë°°ë‹¬ ì„œë¹„ìŠ¤ í—ˆìš© ë…¼ë€", "ì•ˆë©´ ì¸ì‹ ê¸°ìˆ ê³¼ ê°œì¸ì •ë³´ ì¹¨í•´",
    "ë””ì§€í„¸ ìŠí˜€ì§ˆ ê¶Œë¦¬ ë²•ì œí™”", "ê³µì˜ë°©ì†¡(KBS, MBC) ìˆ˜ì‹ ë£Œ ë¶„ë¦¬ ì§•ìˆ˜", "ë°©ì†¡í†µì‹ ì‹¬ì˜ìœ„ì›íšŒ ì¸í„°ë„· ê²€ì—´ ë…¼ë€",
    "í¬í„¸ ì‚¬ì´íŠ¸ ë‰´ìŠ¤ ì œíœ´ í‰ê°€ ë° ë‹¤ìŒ ì¹´ì¹´ì˜¤ ë‰´ìŠ¤ ê°œí¸",

    # êµ¬ì²´ì  ì‚¬ê±´ ë° ê¸°íƒ€ ì´ìŠˆ
    "í•´ë³‘ëŒ€ ì±„ ìƒë³‘ ì‚¬ë§ ì‚¬ê±´ ìˆ˜ì‚¬ ì™¸ì••", "ì´íƒœì› ì°¸ì‚¬ ì±…ì„ì ì²˜ë²Œ ë° íŠ¹ë³„ë²•", "ì˜¤ì†¡ ì§€í•˜ì°¨ë„ ì°¸ì‚¬ ì±…ì„ ê³µë°©",
    "LH ì•„íŒŒíŠ¸ ì² ê·¼ ëˆ„ë½ (ìˆœì‚´ ì•„íŒŒíŠ¸)", "ì¼ë²„ë¦¬ ëŒ€íšŒ ë¶€ì‹¤ ìš´ì˜ ë° ì˜ˆì‚° ë‚­ë¹„", "ë¶€ì‚° ì—‘ìŠ¤í¬ ìœ ì¹˜ ì‹¤íŒ¨ ì›ì¸",
    "ì‹ ë¦¼ë™/ì„œí˜„ì—­ í‰ê¸° ë‚œë™ (ë¬»ì§€ë§ˆ ë²”ì£„)", "ë¶€ì‚° ëŒë ¤ì°¨ê¸° ì‚¬ê±´ ë° í”¼í•´ì ì‹ ìƒ ê³µê°œ", "ì •ìœ ì • í† ë§‰ ì‚´ì¸ ì‚¬ê±´",
    "ì „ì²­ì¡° ì‚¬ê¸° ì‚¬ê±´ê³¼ ì¬ë²Œ ì‚¬ì¹­", "ë¹Œë¼ì™• ì „ì„¸ ì‚¬ê¸° ì‚¬ê±´", "ë¼ì„/ì˜µí‹°ë¨¸ìŠ¤ í€ë“œ ì‚¬ê¸° ì‚¬ê±´",
    "ëŒ€ì¥ë™ ê°œë°œ íŠ¹í˜œ ì˜í˜¹", "ë°±í˜„ë™ ê°œë°œ ë¹„ë¦¬ ì˜í˜¹", "ê¹€ë‚¨êµ­ ì½”ì¸ íˆ¬ê¸° ì˜í˜¹",
    "ëˆë´‰íˆ¬ ì „ë‹¹ëŒ€íšŒ ì˜í˜¹", "ìš¸ì‚° ì‹œì¥ ì„ ê±° ê°œì… ì˜í˜¹", "ì›”ì„± ì›ì „ ê²½ì œì„± ì¡°ì‘ ì˜í˜¹",
    "ì„œí•´ ê³µë¬´ì› í”¼ê²© ì‚¬ê±´ ì›”ë¶ ì¡°ì‘ ë…¼ë€", "íƒˆë¶ ì–´ë¶€ ê°•ì œ ë¶ì†¡ ì‚¬ê±´", "ì²œì•ˆí•¨ í”¼ê²© ì‚¬ê±´ ìŒëª¨ë¡ ",
    "ì„¸ì›”í˜¸ ì°¸ì‚¬ ê´€ë ¨ ìŒëª¨ë¡  ë° ì§„ìƒ ê·œëª…", "ê°€ìŠµê¸° ì‚´ê· ì œ ì°¸ì‚¬ ë°°ìƒ ë¬¸ì œ",
    "BMW í™”ì¬ ê²°í•¨ ì€í ì˜í˜¹", "ì „ê¸°ì°¨ í™”ì¬ ê³µí¬ ë° ì§€í•˜ ì£¼ì°¨ì¥ ê¸ˆì§€",
    "SPC ì œë¹µê³µì¥ ë¼ì„ ì‚¬ë§ ì‚¬ê³  ë¶ˆë§¤ ìš´ë™", "ì¿ íŒ¡ ë¬¼ë¥˜ì„¼í„° í™”ì¬ ë° ë…¸ë™ í™˜ê²½",
    "ì¹´ì¹´ì˜¤ ë¨¹í†µ ì‚¬íƒœ ë° ë…ê³¼ì ", "ë¨¸ì§€í¬ì¸íŠ¸ ì‚¬íƒœ (í°ì§€ ì‚¬ê¸°)", "í‹°ëª¬/ìœ„ë©”í”„ ì •ì‚° ì§€ì—° ì‚¬íƒœ",

    # í•œêµ­ ë¬¸í™” íŠ¹í™” ì†Œì£¼ì œ
    "ì¶”ì„/ì„¤ ëª…ì ˆ ì°¨ë¡€ìƒ ê°„ì†Œí™” ë° íì§€", "ëª…ì ˆ ì¦í›„êµ°ê³¼ ì´í˜¼ìœ¨ ì¦ê°€", "ì œì‚¬ ë¬¸í™” ì¡´í ë…¼ìŸ",
    "í•œêµ­ì‹ ë‚˜ì´ íì§€ (ë§Œ ë‚˜ì´ í†µì¼)", "íšŒì‹ ë¬¸í™” ê°•ìš” ë° ê±´ë°°ì‚¬ ê°‘ì§ˆ", "ê¼°ëŒ€ ë¬¸í™”ì™€ MZì„¸ëŒ€ ê°ˆë“±",
    "ë”ì¹˜í˜ì´ ë¬¸í™”ì™€ ë°ì´íŠ¸ ë¹„ìš© ë…¼ìŸ", "ì¶•ì˜ê¸ˆ ì•¡ìˆ˜ ê¸°ì¤€ (ë°¥ê°’ ìƒìŠ¹)", "ëŒì”ì¹˜/ê²°í˜¼ì‹ ë¯¼í í•˜ê° ë…¼ë€",
    "ì¡°ì˜ê¸ˆ ë´‰íˆ¬ ì¬ì‚¬ìš© ë…¼ë€", "ì§€í•˜ì²  ì©ë²Œë‚¨/ë‹¤ê¼¬ê¸°/ë°±íŒ© ë¹ŒëŸ°", "ê³µê³µì¥ì†Œ ìŠ¤í”¼ì»¤í° í†µí™”",
    "ì•„íŒŒíŠ¸ ì¸µê°„ í¡ì—°(ë² ë€ë‹¤, í™”ì¥ì‹¤)", "ê¸¸ê±°ë¦¬ ì“°ë ˆê¸° ë¬´ë‹¨ íˆ¬ê¸° ë° CCTV", "ì¼íšŒìš© ì»µ ë³´ì¦ê¸ˆì œ ì‹œí–‰",
    "ë¹„ë‹ë´‰íˆ¬ ì‚¬ìš© ê¸ˆì§€ ë° í¸ì˜ì  ê°ˆë“±", "ì‹ë‹¹ íŒ(Tip) ë¬¸í™” ë„ì… ì‹œë„ ë…¼ë€", "í‚¤ì˜¤ìŠ¤í¬ ë…¸ì¸ ì†Œì™¸ í˜„ìƒ",
    "ê³µë¬´ì› ì ì‹¬ì‹œê°„ íœ´ë¬´ì œ ì‹œí–‰", "ë¸Œë ˆì´í¬ íƒ€ì„ í™•ëŒ€ ë° ì†Œë¹„ì ë¶ˆí¸", "ë°°ë‹¬ ìµœì†Œ ì£¼ë¬¸ ê¸ˆì•¡ ì¸ìƒ",
    "íƒì‹œ ì‹¬ì•¼ í• ì¦ í™•ëŒ€ ë° ìŠ¹ì°¨ ê±°ë¶€", "ì¹´í’€ ì„œë¹„ìŠ¤ ë„ì… ì¬ì‹œë„", "ì „ë™ í‚¥ë³´ë“œ í—¬ë©§ ì˜ë¬´í™” ë° ê²¬ì¸",
    "ì˜¤í† ë°”ì´ ì†ŒìŒ ë° ë²ˆí˜¸íŒ ì „ë©´ ë¶€ì°©", "ì–´ë¦°ì´ ë³´í˜¸êµ¬ì—­ ì†ë„ ì œí•œ (3050) íƒ„ë ¥ ìš´ì˜",
    "ìš°íšŒì „ ì¼ì‹œ ì •ì§€ ë‹¨ì† ì‹¤íš¨ì„±", "ê³ ì†ë„ë¡œ 1ì°¨ë¡œ ì •ì† ì£¼í–‰ ë‹¨ì†", "ë°©ìŒí„°ë„ í™”ì¬ ì·¨ì•½ì„± ë° êµì²´",
    "ì‹±í¬í™€(ì§€ë°˜ ì¹¨í•˜) ë°œìƒ ë° ì•ˆì „ ë¶ˆê°ì¦", "ë¶€ì‹¤ ê¸‰ì‹ ë…¼ë€ (êµ°ëŒ€, í•™êµ)", "ì¡°ë¦¬ë³‘/ì¡°ë¦¬ì‚¬ ì¸ë ¥ë‚œ",
    "ROTC ì§€ì›ìœ¨ ê¸‰ê° ë° ì´ˆê¸‰ ê°„ë¶€ ì²˜ìš°", "êµ°ëŒ€ ë‚´ ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš© ì‹œê°„ í™•ëŒ€", "ë³‘ì‚¬ ì›”ê¸‰ 200ë§Œì› ì¸ìƒê³¼ ê°„ë¶€ ì—­ì°¨ë³„",
    "ì˜ˆë¹„êµ° í›ˆë ¨ ë³´ìƒë¹„ í˜„ì‹¤í™”", "ë¯¼ë°©ìœ„ í›ˆë ¨ ì‹¤íš¨ì„± ë° ì—¬ì„± ì°¸ì—¬", "êµ­êµ°ì˜ ë‚  ì‹œê°€ í–‰ì§„ ì˜ˆì‚° ë‚­ë¹„",

    # ì¶”ê°€ í™•ì¥
    "êµê¶Œ ë³´í˜¸ 4ë²• ì•ˆì°© ì—¬ë¶€", "í•™í­ ì „ë¬¸ ë³€í˜¸ì‚¬ ì‹œì¥ í™•ëŒ€", "ì‚¬ë¦½í•™êµ ì±„ìš© ë¹„ë¦¬",
    "ì§€ë°© êµìœ¡ êµë¶€ê¸ˆ ì¶•ì†Œ ë° ìœ ì´ˆì¤‘ê³  ì˜ˆì‚°", "ê·¸ë¦°ìŠ¤ë§ˆíŠ¸ ë¯¸ë˜í•™êµ ì‚¬ì—… ë°˜ëŒ€", "ì „ì êµê³¼ì„œ(AI ë””ì§€í„¸ êµê³¼ì„œ) ë„ì… ìš°ë ¤",
    "ë¬¸í•´ë ¥ ì €í•˜ì™€ í•œì êµìœ¡ ë¶€í™œë¡ ", "ìˆ˜ëŠ¥ ì ˆëŒ€í‰ê°€ ì „í™˜", "ëŒ€í•™ ì…ì‹œ ìˆ˜ì‹œ vs ì •ì‹œ ë¹„ìœ¨",
    "ë¡œìŠ¤ì¿¨ ì…ì‹œ ê³µì •ì„± ë° ì‚¬ë²•ê³ ì‹œ ë¶€í™œ", "ì˜ì „ì›/ì¹˜ì „ì› ì…ì‹œ ë¹„ë¦¬", "ìŒëŒ€/ë¯¸ëŒ€ ì…ì‹œ ë¹„ë¦¬",
    "ì²´ìœ¡ íŠ¹ê¸°ì ì…ì‹œ ë¹„ë¦¬", "í”„ë¡œì•¼êµ¬ ì‹¬íŒ ë§¤ìˆ˜ ë° ìŠ¹ë¶€ ì¡°ì‘", "í”„ë¡œë°°êµ¬ í•™êµí­ë ¥ í‡´ì¶œ ì„ ìˆ˜ ë³µê·€",
    "êµ­ê°€ëŒ€í‘œ ì„ ë°œ ê³¼ì • ê³µì •ì„± (ì¶•êµ¬í˜‘íšŒ ë“±)", "eìŠ¤í¬ì¸  ì•„ì‹œì•ˆê²Œì„ ì •ì‹ ì¢…ëª© ë° ë³‘ì—­",
    "í™•ë¥ í˜• ì•„ì´í…œ ê·œì œì™€ ê²Œì„ì‚¬ ë°˜ë°œ", "ì¸ë””ê²Œì„ ì‹¬ì˜ ì œë„ ê°œì„ ", "ì›¹íˆ° ê²€ì—´ ë° ì—¬ì„±í˜ì˜¤ ë…¼ë€",
    "ë„¤ì´ë²„/ì¹´ì¹´ì˜¤ ì›¹íˆ° ì‘ê°€ ì²˜ìš°", "ìŒì› ì‚¬ì¬ê¸° ì˜í˜¹ ë° ìˆœìœ„ ì¡°ì‘", "ì•„ì´ëŒ íŒ¬ë¤ ë¬¸í™”ì™€ ê³¼ì†Œë¹„ ì¡°ì¥ (í¬í† ì¹´ë“œ)",
    "ì§€í•˜ì²  ì—­ì‚¬ ë‚´ ì‹œìœ„ ë° ì¶œê·¼ê¸¸ ì§€ì—°", "ì „êµ­ë¯¼ì£¼ë…¸ë™ì¡°í•©ì´ì—°ë§¹(ë¯¼ì£¼ë…¸ì´) ì§‘íšŒ", "ë³´ìˆ˜ ë‹¨ì²´ ê´‘í™”ë¬¸ ì§‘íšŒ",
    "ì½”ë¡œë‚˜19 ë°±ì‹  ë¶€ì‘ìš© êµ­ê°€ ë°°ìƒ", "ì‹¤ë‚´ ë§ˆìŠ¤í¬ ì°©ìš© ì˜ë¬´ í•´ì œ ì‹œì ", "í™•ì§„ì ìê°€ ê²©ë¦¬ ì§€ì›ê¸ˆ ì¶•ì†Œ",
    "ê°ì—¼ë³‘ ì „ë‹´ ë³‘ì› ì†ì‹¤ ë³´ìƒ", "ê³µê³µì˜ë£Œì› í™•ì¶© ë° ì˜ˆë¹„íƒ€ë‹¹ì„± ë©´ì œ", "ë¹„ë§Œ ì¹˜ë£Œì œ ê±´ê°•ë³´í—˜ ì ìš©",
    "íƒˆëª¨ ì¹˜ë£Œì œ ê±´ê°•ë³´í—˜ ì ìš© ê³µì•½", "í•œì•½ ì²©ì•½ ê±´ê°•ë³´í—˜ ì‹œë²”ì‚¬ì—…", "ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ë‹¨ë… ê°œì› í—ˆìš©",
    "ê°„í˜¸ë²• ì œì • ê±°ë¶€ê¶Œ í–‰ì‚¬", "ì˜ì‚¬ ë©´í—ˆ ì·¨ì†Œë²• (ê¸ˆê³  ì´ìƒ í˜•)", "PA(ì§„ë£Œ ë³´ì¡°) ê°„í˜¸ì‚¬ í•©ë²•í™”",
    "ì‘ê¸‰ì‹¤ ëº‘ëº‘ì´ ë° í•„ìˆ˜ ì˜ë£Œ ë¶•ê´´", "ì†Œì•„ê³¼ ì˜¤í”ˆëŸ° ë° íì—… ê°€ì†í™”", "ì‚°ë¶€ì¸ê³¼ ë¶„ë§Œ ì¸í”„ë¼ ë¶•ê´´",
    "ì§€ë°© ì˜ë£Œì› ì˜ì‚¬ êµ¬ì¸ë‚œ (ì—°ë´‰ 4ì–µ)", "ê³µì¤‘ë³´ê±´ì˜ ë³µë¬´ ê¸°ê°„ ë‹¨ì¶•", "êµ°ì˜ê´€ íŒŒê²¬ ë° ì˜ë£Œ ê³µë°±",
    "êµ­ë¯¼ê±´ê°•ë³´í—˜ ì™¸êµ­ì¸ ë¬´ì„ìŠ¹ì°¨ ë…¼ë€", "ê±´ê°•ë³´í—˜ í”¼ë¶€ì–‘ì ìê²© ê°•í™”", "ìš”ì–‘ë³‘ì› ê°„ë³‘ë¹„ ê¸‰ì—¬í™”",
    "ì¹˜ë§¤ êµ­ê°€ ì±…ì„ì œ ì‹¤íš¨ì„±", "ê³ ë…ì‚¬ ì˜ˆë°© ë° ë¬´ì—°ê³  ì‚¬ë§ì ì²˜ë¦¬", "1ì¸ ê°€êµ¬ ì§€ì› ì •ì±… í™•ëŒ€",
    "ì²­ë…„ ë„ì•½ ê³„ì¢Œ ì‹¤íš¨ì„±", "ì²­ë…„ ë‚´ì¼ ì±„ì›€ ê³µì œ ì¶•ì†Œ", "ì‹¤ì—… ê¸‰ì—¬ í•˜í•œì•¡ ì¸í•˜ ë° ë°˜ë³µ ìˆ˜ê¸‰",
    "êµ¬ì§ ë‹¨ë… ì²­ë…„ (ë‹ˆíŠ¸ì¡±) ì§€ì›", "ì€ë‘”í˜• ì™¸í†¨ì´ ì‚¬íšŒ ë³µê·€ ì§€ì›", "ê°€ì¡± ëŒë´„ ì²­ë…„ (ì˜ ì¼€ì–´ëŸ¬) ì§€ì›",
    "ë³´í˜¸ ì¢…ë£Œ ì•„ë™(ìë¦½ ì¤€ë¹„ ì²­ë…„) ì§€ì›ê¸ˆ", "í•œë¶€ëª¨ ê°€ì • ì–‘ìœ¡ë¹„ ì„ ì§€ê¸‰ì œ", "ì‚¬ì‹¤í˜¼ ë¶€ë¶€ ë²•ì  ë³´í˜¸ ë²”ìœ„",
    "ìƒí™œ ë™ë°˜ìë²• ì œì • (ë™ê±° ê°€ì¡±)", "ì¹œì¡± ê°„ í˜¼ì¸ ê¸ˆì§€ ë²”ìœ„ ì¶•ì†Œ (8ì´Œ->4ì´Œ)", "ë‚™íƒœ ìˆ˜ìˆ  ì˜ì‚¬ ê±°ë¶€ê¶Œ",
    "í˜¸ì£¼ì œ íì§€ ì´í›„ ë¶€ì„± ìš°ì„  ì›ì¹™ íê¸°", "ìë…€ ì„±(å§“) ê²°ì • ì‹œ ì—„ë§ˆ ì„± ë”°ë¥´ê¸°",
    "ì—¬ì„± ì•ˆì‹¬ ê·€ê°“ê¸¸ ì˜ˆì‚° ì‚­ê°", "ê³µì¤‘ í™”ì¥ì‹¤ ë¶ˆë²• ì´¬ì˜(ëª°ì¹´) ë‹¨ì†", "ë””ì§€í„¸ ì„±ë²”ì£„ ì–‘í˜• ê¸°ì¤€ ê°•í™”",
    "ìŠ¤í† í‚¹ ì ì • ì¡°ì¹˜ (ìœ„ì¹˜ ì¶”ì  ì „ì ì¥ì¹˜)", "ë°ì´íŠ¸ í­ë ¥ ì‚¼ì§„ì•„ì›ƒì œ", "êµì œ í­ë ¥ ì²˜ë²Œë²• ì œì •",
    "ê°€ì • í­ë ¥ ì²˜ë²Œë²•ìƒ ë°˜ì˜ì‚¬ë¶ˆë²Œì£„ íì§€", "ì•„ë™ í•™ëŒ€ ì „ë‹´ ê³µë¬´ì› ê¶Œí•œ ê°•í™”", "ì •ì¸ì´ ì‚¬ê±´ í›„ì† ì¡°ì¹˜",
    "ì…ì–‘ ìˆ™ë ¤ì œ ë° ì…ì–‘ íŠ¹ë¡€ë²•", "ë² ì´ë¹„ë°•ìŠ¤ ìœ ê¸° ì•„ë™ ë³´í˜¸", "ì¶œìƒ ë¯¸ì‹ ê³  ì•„ë™ (ìœ ë ¹ ì•„ë™) ì „ìˆ˜ ì¡°ì‚¬",
    "ë³‘ì› ë°– ì¶œì‚° ë° ì¶œìƒ í†µë³´ì œ", "ë³´í˜¸ ì¶œì‚°ì œ(ìµëª… ì¶œì‚°) ë„ì…", "ìœ¡ì•„ íœ´ì§ ì˜ë¬´í™” ë° ê¸‰ì—¬ ì¸ìƒ",
    "ë‚¨ì„± ìœ¡ì•„ íœ´ì§ ì‚¬ìš©ë¥  ì œê³ ", "ìœ¡ì•„ê¸° ë‹¨ì¶• ê·¼ë¬´ í™•ëŒ€", "ì‹œì°¨ ì¶œí‡´ê·¼ì œ ë° ìœ ì—° ê·¼ë¬´ì œ",
    "ì¬íƒ ê·¼ë¬´ ì¶•ì†Œ ë° ì‚¬ë¬´ì‹¤ ë³µê·€ ê°ˆë“±", "ì›Œì¼€ì´ì…˜ ì§€ì› ë° ì§€ë°© í™œì„±í™”", "ì£¼ 4ì¼ì œ ë„ì… ì‹¤í—˜"
    ]

    # ìƒ˜í”Œ í† í”½ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ (ì‹¤í–‰ ì‹œê°„ ë‹¨ì¶•)
    test_topics = [
        "ì¼ë³¸êµ° ìœ„ì•ˆë¶€ ë°°ìƒ íŒê²° ë° ì™¸êµ ë§ˆì°°",
        "í›„ì¿ ì‹œë§ˆ ì˜¤ì—¼ìˆ˜ ë°©ë¥˜ ì•ˆì „ì„± ë…¼ë€",
        "ì—¬ì„± ì§•ë³‘ì œ ë„ì… ë° êµ° ê°€ì‚°ì  ë¶€í™œ",
        "ë™ì„± ê²°í˜¼ ë²•ì œí™” ë° íŒŒíŠ¸ë„ˆì‹­ ì¸ì •",
        "ê°œ ì‹ìš© ê¸ˆì§€ë²• (ë³´ì‹ íƒ• ì¢…ì‹)",
        "ë”¥í˜ì´í¬ ì„±ì°©ì·¨ë¬¼ ì²˜ë²Œ ë° ê·œì œ",
        "ê²Œì„ ì¤‘ë… ì§ˆë³‘ ì½”ë“œ ë“±ì¬ (WHO)",
        "ìƒì„±í˜• AI ì €ì‘ê¶Œ ì¹¨í•´ (í•™ìŠµ ë°ì´í„°)",
        "í•´ë³‘ëŒ€ ì±„ ìƒë³‘ ì‚¬ë§ ì‚¬ê±´ ìˆ˜ì‚¬ ì™¸ì••",
        "ì „ì„¸ ì‚¬ê¸° í”¼í•´ì êµ¬ì œ (ì„ êµ¬ì œ í›„íšŒìˆ˜)"
    ]

    # ì‚¬ìš©í•  í† í”½ ì„ íƒ (ì „ì²´ í† í”½ ì‚¬ìš©)
    topics = full_topics  # ì „ì²´ í† í”½ ë¦¬ìŠ¤íŠ¸ ì‚¬ìš©

def save_results(results: List[Dict], filename: str):
    """ê²°ê³¼ë¥¼ JSON íŒŒì¼ë¡œ ì €ì¥"""
    output_path = Path("results_topic") / filename
    output_path.parent.mkdir(exist_ok=True)

    with open(output_path, 'w', encoding='utf-8') as f:
        json.dump(results, f, ensure_ascii=False, indent=2)

    print(f"âœ… Results saved to {output_path}")

def main():
    import time

    try:
        print("ğŸš€ Starting KT AI Risk Topic Classification")
        print(f"ğŸ“Š Total topics to process: {len(topics)}")

        # ë¶„ë¥˜ê¸° ì´ˆê¸°í™”
        classifier = KTRiskClassifier(MODEL_PATH, batch_size=8)

        start_time = time.time()

        # Method 1: Single Label
        print(f"\nğŸ” [Method 1] Single Label Classification")
        res1 = classifier.classify_single(topics)
        save_results(res1, "single_label_results.json")

        # ì¼ë¶€ ê²°ê³¼ ìƒ˜í”Œ ì¶œë ¥
        print("ğŸ“‹ Sample results:")
        for r in res1[:3]:
            print(f"  {r['topic'][:50]}... -> {r['result']}")

        # Method 2: Multi Label
        print(f"\nğŸ” [Method 2] Multi Label Classification")
        res2 = classifier.classify_multi(topics)
        save_results(res2, "multi_label_results.json")

        print("ğŸ“‹ Sample results:")
        for r in res2[:3]:
            categories = r['result']
            print(f"  {r['topic'][:50]}... -> {categories}")

        # Method 3: Binary Scan (ê°€ì¥ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¼)
        print(f"\nğŸ” [Method 3] Binary Scan Classification")
        print(f"âš ï¸  This will process {len(topics) * len(RISK_CATEGORIES)} inferences...")
        res3 = classifier.classify_binary_scan(topics)
        save_results(res3, "binary_scan_results.json")

        print("ğŸ“‹ Sample results:")
        for r in res3[:3]:
            matched = r['matched']
            print(f"  {r['topic'][:50]}... -> Matched: {matched}")

        # ì‹¤í–‰ ì‹œê°„ ì¶œë ¥
        end_time = time.time()
        duration = end_time - start_time
        print(".2f")
        print("âœ… All processing completed successfully!")
        print(f"ğŸ“ Results saved in: results_topic/")

    except Exception as e:
        logger.error(f"Error occurred: {e}")
        import traceback
        logger.error(traceback.format_exc())
        return 1

    return 0

if __name__ == "__main__":
    exit(main())